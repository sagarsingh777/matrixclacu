<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix Calculator</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f2f4f8;
      padding: 40px;
      color: #333;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }
    .matrix-input {
      margin-bottom: 20px;
    }
    input[type="number"] {
      width: 50px;
      height: 40px;
      font-size: 16px;
      text-align: center;
      margin: 5px;
    }
    .buttons button {
      background-color: #0069ed;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .result {
      background: white;
      padding: 20px;
      margin-top: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      font-size: 18px;
    }
  </style>
</head>
<body>
  <h1>Matrix Calculator</h1>

  <label for="matrixOrder">Select matrix order:</label>
  <select id="matrixOrder">
    <option value="2">2x2</option>
    <option value="3">3x3</option>
  </select>
  <button onclick="createMatrixInputs()">Next</button>

  <div id="matrixInputs" class="matrix-input"></div>

  <div class="buttons">
    <button onclick="calculateAdjugate()">Adjugate</button>
    <button onclick="calculateDeterminant()">Determinant</button>
    <button onclick="raiseToPower()">Power</button>
    <input type="number" id="power" placeholder="n" style="width: 40px">
  </div>

  <div id="result" class="result"></div>

  <script>
    let matrixSize = 2;

    function createMatrixInputs() {
      matrixSize = parseInt(document.getElementById("matrixOrder").value);
      const container = document.getElementById("matrixInputs");
      container.innerHTML = '';
      for (let i = 0; i < matrixSize; i++) {
        for (let j = 0; j < matrixSize; j++) {
          const input = document.createElement("input");
          input.type = "number";
          input.id = `cell-${i}-${j}`;
          container.appendChild(input);
        }
        container.appendChild(document.createElement("br"));
      }
      document.getElementById("result").innerHTML = '';
    }

    function getMatrix() {
      const matrix = [];
      for (let i = 0; i < matrixSize; i++) {
        const row = [];
        for (let j = 0; j < matrixSize; j++) {
          const value = parseFloat(document.getElementById(`cell-${i}-${j}`).value) || 0;
          row.push(value);
        }
        matrix.push(row);
      }
      return matrix;
    }

    function determinant(matrix) {
      if (matrix.length === 2) {
        return matrix[0][0]*matrix[1][1] - matrix[0][1]*matrix[1][0];
      } else {
        return (
          matrix[0][0]*(matrix[1][1]*matrix[2][2] - matrix[1][2]*matrix[2][1]) -
          matrix[0][1]*(matrix[1][0]*matrix[2][2] - matrix[1][2]*matrix[2][0]) +
          matrix[0][2]*(matrix[1][0]*matrix[2][1] - matrix[1][1]*matrix[2][0])
        );
      }
    }

    function cofactor(matrix, row, col) {
      const minor = matrix.filter((_, r) => r !== row).map(r => r.filter((_, c) => c !== col));
      const det = determinant(minor);
      return ((row + col) % 2 === 0 ? 1 : -1) * det;
    }

    function adjugate(matrix) {
      const size = matrix.length;
      const cofactors = [];
      for (let i = 0; i < size; i++) {
        cofactors[i] = [];
        for (let j = 0; j < size; j++) {
          cofactors[i][j] = cofactor(matrix, i, j);
        }
      }
      return cofactors[0].map((_, colIndex) => cofactors.map(row => row[colIndex])); // transpose
    }

    function matrixToLatex(matrix) {
      return `\\begin{bmatrix}${matrix.map(row => row.join(' & ')).join(' \\\\ ')}\\end{bmatrix}`;
    }

    function calculateDeterminant() {
      const m = getMatrix();
      const det = determinant(m);
      document.getElementById("result").innerHTML = `$$
        \text{Matrix: } ${matrixToLatex(m)} \\
        \text{Determinant: } \det(A) = ${det}
      $$`;
      MathJax.typeset();
    }

    function calculateAdjugate() {
      const m = getMatrix();
      const adj = adjugate(m);
      document.getElementById("result").innerHTML = `$$
        \text{Original Matrix: } ${matrixToLatex(m)} \\
        \text{Adjugate: } ${matrixToLatex(adj)}
      $$`;
      MathJax.typeset();
    }

    function multiplyMatrices(a, b) {
      return a.map((row, i) => b[0].map((_, j) => row.reduce((sum, _, k) => sum + a[i][k] * b[k][j], 0)));
    }

    function raiseToPower() {
      const m = getMatrix();
      const n = parseInt(document.getElementById("power").value);
      if (isNaN(n) || n < 1) return alert("Enter valid power n â‰¥ 1");
      let result = m;
      for (let i = 1; i < n; i++) {
        result = multiplyMatrices(result, m);
      }
      document.getElementById("result").innerHTML = `$$
        A = ${matrixToLatex(m)} \\
        A^{${n}} = ${matrixToLatex(result)}
      $$`;
      MathJax.typeset();
    }

    window.onload = createMatrixInputs;
  </script>
</body>
</html>
